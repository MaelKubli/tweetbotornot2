<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>example • tweetbotornot2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="example">
<meta property="og:description" content="">
<meta property="og:image" content="https://tweetbotornot2.mikewk.com/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tweetbotornot2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example.html">example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mkearney/tweetbotornot2">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mkearney/tweetbotornot2/blob/master/vignettes/example.Rmd"><code>vignettes/example.Rmd</code></a></small>
      <div class="hidden name"><code>example.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">## load package</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tweetbotornot2)</span></code></pre></div>
<div id="authentication" class="section level2">
<h2 class="hasAnchor">
<a href="#authentication" class="anchor"></a>Authentication</h2>
<p>Use of this package typically<sup>1</sup> requires, at a minimum, (a) internet connection and (b) an active Twitter account–i.e., you will need to authorize rtweet’s <em>rstats2twitter</em> app to act (communicate from R to Twitter) on behalf of your Twitter account. If you’re already signed into Twitter on your web browser, this can be done with a single click. Otherwise, you will have to sign in and <em>then</em> click.</p>
<p>If you’re working in an interactive R session on a local machine (in the RStudio application, for example), this process should be relatively straight forward. <sup>1</sup> If you’re working on a remote server or in the cloud (in RStudio Server, for example), then it’s a bit trickier. The easiest solution is to start a local, interactive session of R and then do the following:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>On a machine with a local version of R</strong>, send API request via {rtweet}</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>rstats &lt;-<span class="st"> </span>rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/search_tweets.html">search_tweets</a></span>(<span class="st">"rstats"</span>)</span></code></pre></div>
</li>
<li>
<p>The above code actually creates (as a side effect) a Twitter token for you. So, on the same machine, save the token as an <code>.rds</code> file</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/get_tokens.html">get_token</a></span>(), <span class="st">"rtweet_token.rds"</span>)</span></code></pre></div>
</li>
<li><p>Upload the saved token file to your <strong>cloud/server</strong></p></li>
</ol>
<p>Once the token is uploaded to the cloud, you can either read the token file and specify the resulting object in each {tweetbotornot} call, e.g.,</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>token &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="st">"rtweet_token.rds"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw"><a href="../reference/predict_bot.html">predict_bot</a></span>(<span class="st">"jack"</span>, <span class="dt">token =</span> token)</span></code></pre></div>
<p>or set the path to the saved token as an R environment variable. The latter option (example below) allows you to avoid having to specify the token each time.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span>(<span class="dt">TWITTER_PAT =</span> <span class="st">"/path/to/rtweet_token.rds"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw"><a href="../reference/predict_bot.html">predict_bot</a></span>(<span class="st">"jack"</span>)</span></code></pre></div>
<p>To set the R environment variable for current <strong>and</strong> future sessions (on a given machine), you can also try <code><a href="https://tfse.mikewk.com//reference/set_renv.html">tfse::set_renv()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>tfse<span class="op">::</span><span class="kw"><a href="https://tfse.mikewk.com//reference/set_renv.html">set_renv</a></span>(<span class="dt">TWITTER_PAT =</span> <span class="st">"/path/to/rtweet_token.rds"</span>)</span></code></pre></div>
</div>
<div id="bot-scores" class="section level2">
<h2 class="hasAnchor">
<a href="#bot-scores" class="anchor"></a>Bot scores</h2>
<p>The main use of this package is to get bot-probability estimates of one or more Twitter accounts. This can be done with the <code><a href="../reference/predict_bot.html">predict_bot()</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="../reference/predict_bot.html">predict_bot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"netflix_bot"</span>, <span class="st">"PatrickMahomes"</span>))</span></code></pre></div>
<div id="rate-limits" class="section level3">
<h3 class="hasAnchor">
<a href="#rate-limits" class="anchor"></a>Rate limits</h3>
<p>Assuming you haven’t made any recent calls to Twitter’s API, the above function should work for up to 900 users at a time. If you are able to convert your Twitter token into a bearer token with {rtweet} (this is not always possible; it depends on a number of things; try the code below to see if you can), you should be able to get estimates for up to 1,500 accounts at a time. You can use the following code to see if the bearer token will work for you.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">## specify token if R environment variable isn't set</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/search_tweets.html">search_tweets</a></span>(<span class="st">"rstats"</span>, <span class="dt">token =</span> rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/bearer_token.html">bearer_token</a></span>())</span></code></pre></div>
<p>If the above code returns a data frame of tweets data, then you can specify the bearer token in <code><a href="../reference/predict_bot.html">predict_bot()</a></code> the same way. The code below checks your bearer token rate limit before and after executing <code><a href="../reference/predict_bot.html">predict_bot()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/rate_limit.html">rate_limit</a></span>(rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/bearer_token.html">bearer_token</a></span>(), <span class="st">"get_timeline"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw"><a href="../reference/predict_bot.html">predict_bot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"netflix_bot"</span>, <span class="st">"PatrickMahomes"</span>), <span class="dt">token =</span> rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/bearer_token.html">bearer_token</a></span>())</span>
<span id="cb9-3"><a href="#cb9-3"></a>rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/rate_limit.html">rate_limit</a></span>(rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/bearer_token.html">bearer_token</a></span>(), <span class="st">"get_timeline"</span>)</span></code></pre></div>
</div>
<div id="example-users" class="section level3">
<h3 class="hasAnchor">
<a href="#example-users" class="anchor"></a>Example users</h3>
<p>For example purposes, this vignette retrieves user IDs from accounts appearing on a Twitter list of 2020 Democratic presidential candidates.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">## get accounts from the twitter list: twitter.com/kearneymw/lists/dems-pres-2020</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>d20 &lt;-<span class="st"> </span>rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/lists_members.html">lists_members</a></span>(<span class="dt">owner_user =</span> <span class="st">"kearneymw"</span>, <span class="dt">slug =</span> <span class="st">"dems-pres-2020"</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">## store IDs as 'users' vector</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>users &lt;-<span class="st"> </span>d20<span class="op">$</span>user_id</span></code></pre></div>
</div>
<div id="making-large-requests" class="section level3">
<h3 class="hasAnchor">
<a href="#making-large-requests" class="anchor"></a>Making large requests</h3>
<p>To get estimates for hundreds or thousands of users, it is wise to use a for-loop and wait for the rate limit reset by sleeping between calls. This can be done in a number of ways, but the functions <code><a href="../reference/chunk_users.html">chunk_users()</a></code> and <code><a href="../reference/chunk_users.html">chunk_users_data()</a></code> are provided to make this easier. The code below should work for either user or bearer (rtweet) token. It also prints out rate limit information and percent complete information.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">## convert users vector (user IDs or screen names) a list of 10-user chunks</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>users &lt;-<span class="st"> </span><span class="kw"><a href="../reference/chunk_users.html">chunk_users</a></span>(users, <span class="dt">n =</span> <span class="dv">10</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">## initialize output vector</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>output &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(users))</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(output)) {</span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="co">## check rate limit- if &lt; 10 calls remain, sleep until reset</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(rl &lt;-<span class="st"> </span>rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/rate_limit.html">rate_limit</a></span>(<span class="dt">query =</span> <span class="st">"get_timelines"</span>))</span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="cf">while</span> (rl[[<span class="st">"remaining"</span>]] <span class="op">&lt;</span><span class="st"> </span>10L) {</span>
<span id="cb11-11"><a href="#cb11-11"></a>    <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Sleeping for"</span>, <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(rl[[<span class="st">"reset"</span>]], <span class="st">"mins"</span>), <span class="fl">0.5</span>), <span class="dv">1</span>), <span class="st">"minutes..."</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a>    <span class="kw"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(rl[[<span class="st">"reset"</span>]], <span class="st">"secs"</span>), <span class="dv">30</span>))</span>
<span id="cb11-13"><a href="#cb11-13"></a>    rl &lt;-<span class="st"> </span>rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/rate_limit.html">rate_limit</a></span>(<span class="dt">query =</span> <span class="st">"get_timelines"</span>)</span>
<span id="cb11-14"><a href="#cb11-14"></a>  }</span>
<span id="cb11-15"><a href="#cb11-15"></a>  </span>
<span id="cb11-16"><a href="#cb11-16"></a>  <span class="co">## get bot estimates</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>  output[[i]] &lt;-<span class="st"> </span><span class="kw"><a href="../reference/predict_bot.html">predict_bot</a></span>(users[[i]])</span>
<span id="cb11-18"><a href="#cb11-18"></a>  </span>
<span id="cb11-19"><a href="#cb11-19"></a>  <span class="co">## print iteration update</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>  <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%d / %d (%.f%%)</span><span class="ch">\n</span><span class="st">"</span>, i, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(output), i <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(output) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>))</span>
<span id="cb11-21"><a href="#cb11-21"></a>}</span>
<span id="cb11-22"><a href="#cb11-22"></a></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">## merge into single data table</span></span>
<span id="cb11-24"><a href="#cb11-24"></a>output &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="st">"rbind"</span>, output)</span>
<span id="cb11-25"><a href="#cb11-25"></a></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="co">## sort by bot probability</span></span>
<span id="cb11-27"><a href="#cb11-27"></a>output[<span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="op">-</span>prob_bot), ]</span></code></pre></div>
<p>If you’d also like to keep the raw (timeline) Twitter data, the above for loop can be modified to collect the Twitter data prior to generating estimates with <code><a href="../reference/predict_bot.html">predict_bot()</a></code>. This is demonstrated in the code below.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">## convert users vector (user IDs or screen names) a list of 10-user chunks</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>users &lt;-<span class="st"> </span><span class="kw"><a href="../reference/chunk_users.html">chunk_users</a></span>(users, <span class="dt">n =</span> <span class="dv">10</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">## initialize output vectors</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>output &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(users))</span>
<span id="cb12-6"><a href="#cb12-6"></a>usrtml &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(users))</span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(output)) {</span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="co">## check rate limit- if &lt; 10 calls remain, sleep until reset</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(rl &lt;-<span class="st"> </span>rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/rate_limit.html">rate_limit</a></span>(<span class="dt">query =</span> <span class="st">"get_timelines"</span>))</span>
<span id="cb12-11"><a href="#cb12-11"></a>  <span class="cf">while</span> (rl[[<span class="st">"remaining"</span>]] <span class="op">&lt;</span><span class="st"> </span>10L) {</span>
<span id="cb12-12"><a href="#cb12-12"></a>    <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Sleeping for"</span>, <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(rl[[<span class="st">"reset"</span>]], <span class="st">"mins"</span>), <span class="fl">0.5</span>), <span class="dv">1</span>), <span class="st">"minutes..."</span>)</span>
<span id="cb12-13"><a href="#cb12-13"></a>    <span class="kw"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(rl[[<span class="st">"reset"</span>]], <span class="st">"secs"</span>), <span class="dv">30</span>))</span>
<span id="cb12-14"><a href="#cb12-14"></a>    rl &lt;-<span class="st"> </span>rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/rate_limit.html">rate_limit</a></span>(<span class="dt">query =</span> <span class="st">"get_timelines"</span>)</span>
<span id="cb12-15"><a href="#cb12-15"></a>  }</span>
<span id="cb12-16"><a href="#cb12-16"></a>  </span>
<span id="cb12-17"><a href="#cb12-17"></a>  <span class="co">## get user timeline data (set check=FALSE to avoid excessive rate-limit calls)</span></span>
<span id="cb12-18"><a href="#cb12-18"></a>  usrtml[[i]] &lt;-<span class="st"> </span>rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/get_timeline.html">get_timelines</a></span>(users[[i]], <span class="dt">n =</span> <span class="dv">200</span>, <span class="dt">check =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-19"><a href="#cb12-19"></a>  </span>
<span id="cb12-20"><a href="#cb12-20"></a>  <span class="co">## use the timeline data to get bot estimates</span></span>
<span id="cb12-21"><a href="#cb12-21"></a>  output[[i]] &lt;-<span class="st"> </span><span class="kw"><a href="../reference/predict_bot.html">predict_bot</a></span>(users[[i]])</span>
<span id="cb12-22"><a href="#cb12-22"></a>  </span>
<span id="cb12-23"><a href="#cb12-23"></a>  <span class="co">## print iteration update</span></span>
<span id="cb12-24"><a href="#cb12-24"></a>  <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%d / %d (%.f%%)</span><span class="ch">\n</span><span class="st">"</span>, i, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(output), i <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(output) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>))</span>
<span id="cb12-25"><a href="#cb12-25"></a>}</span>
<span id="cb12-26"><a href="#cb12-26"></a></span>
<span id="cb12-27"><a href="#cb12-27"></a><span class="co">## merge both data lists into single data tables</span></span>
<span id="cb12-28"><a href="#cb12-28"></a>output &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="st">"rbind"</span>, output)</span>
<span id="cb12-29"><a href="#cb12-29"></a>usrtml &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="st">"rbind"</span>, usrtml)</span>
<span id="cb12-30"><a href="#cb12-30"></a></span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="co">## sort by bot probability</span></span>
<span id="cb12-32"><a href="#cb12-32"></a>output[<span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="op">-</span>prob_bot), ]</span>
<span id="cb12-33"><a href="#cb12-33"></a></span>
<span id="cb12-34"><a href="#cb12-34"></a><span class="co">## preview timeline data</span></span>
<span id="cb12-35"><a href="#cb12-35"></a>usrtml[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ]</span></code></pre></div>
<p><sup>1</sup> Unless you’ve already collected user timeline data, <strong><a href="tweetbotornot2.mikewk.com"><code>{tweetbotornot2}</code></a></strong> relies on <a href="https://rtweet.info"><code>{rtweet}</code></a> to pull data from <a href="https://developer.twitter.com/en/docs">Twitter’s REST API</a>.</p>
<p><sup>2</sup> The first time you make a request [from your computer] to Twitter’s API’s, a browser should pop-up, asking you to authorize the app. After that, the authorization token is stored and remembered behind the scenes (you will only have to reauthorize the app if your Twitter settings or token credentials get reset or if you use a different machine).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#authentication">Authentication</a></li>
      <li><a href="#bot-scores">Bot scores</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://mikewk.com">Michael W. Kearney</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
